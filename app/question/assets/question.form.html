<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../global/assets/global_Bluementa.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <title>Quiz form</title>
</head>

<body>
    <form>
        <div id="general_information">
            <input type="text" name="question_name" id="question_name" placeholder="Kerdes neve">
            <br>
            <input type="text" name="question_description" id="question_description" placeholder="Kerdes leirasa">
            <br>
            <select name="question_type" id="question_type" onchange="GenerateQuestionForm()">
                <option disabled selected>Valasszon kerdes tipust</option>
                <option value="1">Egy helyes valasz</option>
                <option value="2">Tobb helyes valasz</option>
                <option value="3">Valasz parok</option>
                <option value="4">Sorrend</option>
            </select>
        </div>
        <br>
        <div id="question_information">

        </div>
        <br>
        <div id="question_answers">

        </div>
        <div id="question_submit">

        </div>
    </form>

    <script>

        let variable1, variable2, variable3, variable4, variable5, variable6, variable7, variable8 = null;

        let numOfWrongAnswers = numOfRightAnswers = numberOfQuestions = null;
        function GenerateQuestionForm() {
            $("#question_information").html("")
            $("#question_answers").html("")
            $("#question_submit").html("")

            let node = $("#question_type").val()
            switch (node) {
                case "1":
                    GenerateOneAnswerInformation();
                    variable8 = parseInt(node);
                    break;
                case "2":
                    GenerateMultipleAnswerInformation();
                    variable8 = parseInt(node);
                    break;
                case "3":
                    GenerateAnswerPairsInformation();
                    variable8 = parseInt(node);
                    break;
                case "4":
                    GenerateOrderedAnswersInformation();
                    variable8 = parseInt(node);
                    break;
            }
        }

        function GenerateOneAnswerInformation() {
            $("#question_information").html("")

            $("#question_information").append(`<p>Hany rossz valasz legyen?<p>`)

            let howManyQuestions = `
            <select id="num_of_questions" onchange="GenerateOneAnswerForm(this)">
                <option value="" disabled selected>Mennyi legyen?</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select>`

            $("#question_information").append(howManyQuestions)
        }

        function GenerateOneAnswerForm(node) {
            $("#question_answers").html("")

            $("#question_answers").append(`<p>A helyes valasz<p>`)
            $("#question_answers").append(`<input type="text" id="right_answer" placeholder="A jo valasz">`)

            $("#question_answers").append(`<p>A helytelen valaszok<p>`)
            for (let i = 0; i < parseInt(node.value); i++) {
                $("#question_answers").append(`<input type="text" id="wrong_answer${i}" placeholder="Egy rossz valasz"><br>`)
            }

            GenerateSubmitButton();
        }

        function GenerateMultipleAnswerInformation() {
            $("#question_information").html("")

            let questionSelectElement = GenerateSelectElement("num_of_answers", "SetMultipleAnswerFormData(this)")
            $("#question_information").append("<p>Hany kerdes legyen<p>")
            $("#question_information").append(questionSelectElement)

            let answerSelectElement = GenerateSelectElement("num_of_correct_answers", "SetMultipleAnswerFormData(this)")
            $("#question_information").append("<p>Hany jo valasz legyen<p>")
            $("#question_information").append(answerSelectElement)
        }

        function SetMultipleAnswerFormData(node) {

            if (node.id == "num_of_answers") numberOfQuestions = parseInt(node.value)
            if (node.id == "num_of_correct_answers") numOfRightAnswers = parseInt(node.value)

            if (numberOfQuestions !== null && numOfRightAnswers !== null) {
                numOfWrongAnswers = numberOfQuestions - numOfRightAnswers
                GenerateMultipleAnswerForm()
            }
        }

        function GenerateMultipleAnswerForm() {
            $("#question_answers").html("")

            $("#question_answers").append(`<p>A helyes valaszok<p>`)
            for (let i = 1; i < numOfRightAnswers + 1; i++) {
                $("#question_answers").append(`<input type="text" id="right_answer${i}" placeholder="Egy jo valasz"><br>`)
            }

            $("#question_answers").append(`<p>A helytelen valaszok<p>`)
            for (let i = 1; i < numOfWrongAnswers + 1; i++) {
                $("#question_answers").append(`<input type="text" id="wrong_answer${i}" placeholder="Egy rossz valasz"><br>`)
            }

            numOfWrongAnswers = numOfRightAnswers = numberOfQuestions = null;

            GenerateSubmitButton();
        }

        function GenerateAnswerPairsInformation() {
            $("#question_information").html("")

            let pairSelectElement = GenerateSelectElement("num_of_answers_pairs", "GenerateAnswerPairsForm(this)")
            $("#question_information").append(`<p>Hany par<p>`)
            $("#question_information").append(pairSelectElement)
        }

        function GenerateAnswerPairsForm(node) {
            $("#question_answers").html("")

            $("#question_answers").append(`<p>Ide irja a helyes megoldasokat</p>`)
            console.log(numberOfQuestions);
            for (let i = 1; i < parseInt(node.value) + 1; i++) {
                $("#question_answers").append(`<input type="text" class="${i}" id="firstValue" placeholder="A par egyik fele">`)
                $("#question_answers").append(`<input type="text" class="${i}" id="secondValue" placeholder="A par masik fele">`)
                $("#question_answers").append(`<br> <br>`)
            }

            GenerateSubmitButton();
        }

        function GenerateOrderedAnswersInformation() {
            $("#question_information").html("")

            let orderedSelectElement = GenerateSelectElement("num_of_ordered_answers", "GenerateOrderedAnswerForm(this)")
            $("#question_information").append(`<p>Hany legyen<p>`)
            $("#question_information").append(orderedSelectElement)

        }

        function GenerateOrderedAnswerForm(node) {
            $("#question_answers").html("")

            for (let i = 0; i < parseInt(node.value); i++) {
                $("#question_answers").append(`<input type="text" id="${i}" placeholder="${i}. valasz"><br>`)
            }
        }

        function GenerateSelectElement(idName, onchangeFunction) {
            let selectElement = $(`<select id="${idName}" onchange="${onchangeFunction}"></select>`)

            selectElement.append(`<option disabled selected>Mennyi legyen?</option>`)
            for (let i = 1; i < 7; i++) {
                selectElement.append(`<option value="${i}">${i}</option>`)
            }

            return selectElement;
        }

        function GenerateSubmitButton() {
            $("#question_submit").html("")
            $("#question_submit").append(`<button type="button" onclick="SubmitQuestion">Mentes</button>`)
        }

        $.ajax(
            {
                url: "http://localhost/bluementa/Question/app/question/questionupload.php",
                type: 'POST',
                data: {
                    userId: variable1,
                    quizId: variable2,
                    questionQuestion: variable3,
                    questionAnswers: variable4,
                    questionMarkableAnswers: variable5,
                    questionCorrectAnswers: variable6,
                    questionDescription: variable7,
                    questionType: variable8
                },
                dataType: 'json',
                success: function (data, status, xhr) {
                }
            });

        $(document).ready(function () {
            document.getElementById("question_type").onchange = GenerateQuestionForm;
            $.ajax({
                url: "http://localhost/bluementa/Question/app/question/user_id.php",
                type: "GET",
                dataType: "json",
                success: function (data, status, xhr) {
                    variable1 = data
                }
            })
        });
    </script>
</body>

</html>